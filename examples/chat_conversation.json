{
  "_comment": "Example conversation flow for CoachX onboarding chat system",
  "_description": "This file shows the expected structure and flow of the onboarding conversation. Use this as reference for implementing the chat interface and backend logic.",
  
  "conversation_flow": [
    {
      "step": 1,
      "role": "assistant",
      "message": "Â¡Hola! Soy CoachX, tu entrenador personal con inteligencia artificial. ğŸ’ª Estoy aquÃ­ para crear un plan de entrenamiento personalizado para ti. Â¿CuÃ¡l es tu nombre?",
      "expects": "string",
      "validation": {
        "min_length": 2,
        "max_length": 50,
        "required": true
      }
    },
    {
      "step": 2,
      "role": "user",
      "message": "Me llamo Alex",
      "stored_as": "name"
    },
    {
      "step": 3,
      "role": "assistant",
      "message": "Â¡Encantado de conocerte, Alex! ğŸ¤ Para crear tu plan perfecto, necesito conocerte mejor. Â¿CuÃ¡ntos aÃ±os tienes?",
      "expects": "integer",
      "validation": {
        "min": 1,
        "max": 120,
        "required": true,
        "error_message": "Por favor ingresa una edad vÃ¡lida entre 1 y 120 aÃ±os"
      }
    },
    {
      "step": 4,
      "role": "user",
      "message": "28",
      "stored_as": "age"
    },
    {
      "step": 5,
      "role": "assistant",
      "message": "Perfecto, Alex. Â¿QuÃ© deporte practicas o te gustarÃ­a practicar? Puedo ayudarte con: Box ğŸ¥Š, CrossFit ğŸ‹ï¸, Gym ğŸ’ª, Calistenia ğŸ¤¸, o Running ğŸƒ",
      "expects": "enum",
      "validation": {
        "allowed_values": ["boxing", "box", "crossfit", "gym", "gimnasio", "calisthenics", "calistenia", "running", "correr"],
        "normalize_to": {
          "box": "boxing",
          "gimnasio": "gym",
          "calistenia": "calisthenics",
          "correr": "running"
        },
        "required": true,
        "error_message": "Por favor selecciona uno de los deportes disponibles"
      }
    },
    {
      "step": 6,
      "role": "user",
      "message": "Box",
      "stored_as": "sport",
      "normalized_value": "boxing"
    },
    {
      "step": 7,
      "role": "assistant",
      "message": "Â¡Excelente elecciÃ³n! El box es un deporte increÃ­ble. ğŸ¥Š Â¿CuÃ¡l es tu nivel de experiencia? (principiante, intermedio, avanzado)",
      "expects": "enum",
      "validation": {
        "allowed_values": ["beginner", "principiante", "novato", "intermediate", "intermedio", "advanced", "avanzado", "experto"],
        "normalize_to": {
          "principiante": "beginner",
          "novato": "beginner",
          "intermedio": "intermediate",
          "avanzado": "advanced",
          "experto": "advanced"
        },
        "required": true
      }
    },
    {
      "step": 8,
      "role": "user",
      "message": "intermedio",
      "stored_as": "experience_level",
      "normalized_value": "intermediate"
    },
    {
      "step": 9,
      "role": "assistant",
      "message": "Genial, con tu nivel intermedio podemos crear un plan mÃ¡s desafiante. Â¿CuÃ¡ntos dÃ­as por semana puedes entrenar? (1-7 dÃ­as)",
      "expects": "integer",
      "validation": {
        "min": 1,
        "max": 7,
        "required": true,
        "error_message": "Ingresa un nÃºmero entre 1 y 7"
      }
    },
    {
      "step": 10,
      "role": "user",
      "message": "4",
      "stored_as": "days_per_week"
    },
    {
      "step": 11,
      "role": "assistant",
      "message": "Perfecto, 4 dÃ­as a la semana es excelente para progresar. Â¿CuÃ¡l es tu peso actual en kilogramos? (Opcional, puedes omitir escribiendo 'omitir')",
      "expects": "float_or_skip",
      "validation": {
        "min": 30,
        "max": 300,
        "required": false,
        "allow_skip": true,
        "skip_keywords": ["omitir", "skip", "no", "ninguno", "paso"]
      }
    },
    {
      "step": 12,
      "role": "user",
      "message": "75",
      "stored_as": "weight_kg"
    },
    {
      "step": 13,
      "role": "assistant",
      "message": "Â¿Tu altura en centÃ­metros? (Opcional)",
      "expects": "float_or_skip",
      "validation": {
        "min": 100,
        "max": 250,
        "required": false,
        "allow_skip": true
      }
    },
    {
      "step": 14,
      "role": "user",
      "message": "180",
      "stored_as": "height_cm"
    },
    {
      "step": 15,
      "role": "assistant",
      "message": "Â¡Casi listo! Â¿CuÃ¡les son tus objetivos principales? Por ejemplo: mejorar tÃ©cnica, aumentar resistencia, perder peso, ganar mÃºsculo... (MÃ¡ximo 200 caracteres)",
      "expects": "string",
      "validation": {
        "max_length": 200,
        "required": true
      }
    },
    {
      "step": 16,
      "role": "user",
      "message": "Mejorar mi tÃ©cnica de golpes y aumentar mi resistencia cardiovascular",
      "stored_as": "goals"
    },
    {
      "step": 17,
      "role": "assistant",
      "message": "Una Ãºltima pregunta: Â¿Tienes alguna lesiÃ³n o limitaciÃ³n que deba considerar? (Opcional, escribe 'ninguna' si no aplica)",
      "expects": "string_or_skip",
      "validation": {
        "max_length": 500,
        "required": false,
        "allow_skip": true,
        "skip_keywords": ["ninguna", "no", "none", "nada", "omitir"]
      }
    },
    {
      "step": 18,
      "role": "user",
      "message": "Tuve una lesiÃ³n en el hombro derecho hace 6 meses, ya estÃ¡ recuperado pero prefiero no forzarlo",
      "stored_as": "limitations"
    },
    {
      "step": 19,
      "role": "assistant",
      "message": "Â¡Perfecto, Alex! ğŸ‰ Tengo toda la informaciÃ³n que necesito. Voy a crear tu plan personalizado de box considerando tu nivel intermedio, tus objetivos de tÃ©cnica y resistencia, y tu historial de lesiÃ³n en el hombro. Esto tomarÃ¡ solo unos segundos...",
      "action": "generate_plan",
      "final_step": true
    },
    {
      "step": 20,
      "role": "assistant",
      "message": "Â¡Tu plan estÃ¡ listo! ğŸ¥Š He creado un programa de 4 semanas con 4 entrenamientos semanales que te ayudarÃ¡n a mejorar tu tÃ©cnica y resistencia, siendo cuidadoso con tu hombro. Â¿Quieres verlo?",
      "action": "show_plan"
    }
  ],
  
  "collected_data_structure": {
    "name": "Alex",
    "age": 28,
    "sport": "boxing",
    "experience_level": "intermediate",
    "days_per_week": 4,
    "weight_kg": 75.0,
    "height_cm": 180.0,
    "goals": "Mejorar mi tÃ©cnica de golpes y aumentar mi resistencia cardiovascular",
    "limitations": "Tuve una lesiÃ³n en el hombro derecho hace 6 meses, ya estÃ¡ recuperado pero prefiero no forzarlo"
  },
  
  "conversation_states": {
    "not_started": {
      "description": "User hasn't started onboarding yet",
      "next_action": "Show welcome message and start"
    },
    "in_progress": {
      "description": "User is currently answering questions",
      "current_step": "integer (1-18)",
      "next_action": "Ask next question or validate answer"
    },
    "completed": {
      "description": "All questions answered, generating plan",
      "next_action": "Generate workout plan with AI"
    },
    "plan_ready": {
      "description": "Plan has been generated",
      "next_action": "Show plan to user"
    }
  },
  
  "validation_patterns": {
    "name": {
      "type": "string",
      "min_length": 2,
      "max_length": 50,
      "pattern": "^[a-zA-ZÃ¡Ã©Ã­Ã³ÃºÃÃ‰ÃÃ“ÃšÃ±Ã‘ ]+$",
      "error": "El nombre debe tener entre 2 y 50 caracteres y solo contener letras"
    },
    "age": {
      "type": "integer",
      "min": 1,
      "max": 120,
      "error": "La edad debe estar entre 1 y 120 aÃ±os"
    },
    "sport": {
      "type": "enum",
      "allowed": ["boxing", "crossfit", "gym", "calisthenics", "running"],
      "error": "Por favor selecciona un deporte vÃ¡lido"
    },
    "experience_level": {
      "type": "enum",
      "allowed": ["beginner", "intermediate", "advanced"],
      "error": "El nivel debe ser: principiante, intermedio o avanzado"
    },
    "days_per_week": {
      "type": "integer",
      "min": 1,
      "max": 7,
      "error": "Los dÃ­as deben estar entre 1 y 7"
    },
    "weight_kg": {
      "type": "float",
      "min": 30,
      "max": 300,
      "optional": true,
      "error": "El peso debe estar entre 30 y 300 kg"
    },
    "height_cm": {
      "type": "float",
      "min": 100,
      "max": 250,
      "optional": true,
      "error": "La altura debe estar entre 100 y 250 cm"
    },
    "goals": {
      "type": "string",
      "max_length": 200,
      "error": "Los objetivos no pueden exceder 200 caracteres"
    },
    "limitations": {
      "type": "string",
      "max_length": 500,
      "optional": true,
      "error": "Las limitaciones no pueden exceder 500 caracteres"
    }
  },
  
  "ui_considerations": {
    "progress_indicator": "Mostrar 'Pregunta X de 8' o barra de progreso",
    "back_button": "Permitir volver a la pregunta anterior",
    "loading_states": "Mostrar spinner cuando AI estÃ¡ procesando",
    "error_handling": "Mostrar errores de validaciÃ³n de forma amigable",
    "mobile_responsive": "Optimizar para pantallas pequeÃ±as",
    "theme": "Bred (Black + Red) theme throughout",
    "animations": "Suaves transiciones entre preguntas",
    "auto_focus": "Focus automÃ¡tico en input de respuesta"
  },
  
  "backend_implementation": {
    "endpoints": [
      "POST /api/onboarding/start - Iniciar onboarding, devolver primera pregunta",
      "POST /api/onboarding/answer - Enviar respuesta, recibir siguiente pregunta",
      "GET /api/onboarding/status/{user_id} - Obtener estado actual",
      "POST /api/onboarding/back - Volver a pregunta anterior",
      "POST /api/onboarding/complete - Finalizar y guardar datos"
    ],
    "response_format": {
      "success": true,
      "step": 3,
      "total_steps": 8,
      "question": "Â¿CuÃ¡ntos aÃ±os tienes?",
      "expects": "integer",
      "validation": {},
      "can_go_back": true,
      "is_final": false
    },
    "error_format": {
      "success": false,
      "error": "Validation failed",
      "message": "La edad debe estar entre 1 y 120 aÃ±os",
      "field": "age"
    }
  },
  
  "notes_for_implementation": [
    "Use this exact flow for consistent user experience",
    "Validate ALL user inputs before accepting",
    "Store partial progress so users can resume if they leave",
    "Use friendly, motivational language like the examples",
    "Handle typos and variations (box vs boxing, etc.)",
    "Provide clear error messages when validation fails",
    "Show progress so users know how many questions remain",
    "Allow going back to correct previous answers",
    "Add loading states when calling AI for plan generation",
    "Consider rate limiting to prevent abuse"
  ]
}
